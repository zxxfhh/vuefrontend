# PDFç®€åŒ–ä¿®æ”¹ - åˆ é™¤é¡µçœ‰ã€é¡µè„šã€å›¾è¡¨æ ‡é¢˜

## ğŸ¯ ä¿®æ”¹ç›®æ ‡

æ ¹æ®ç”¨æˆ·è¦æ±‚ï¼Œåˆ é™¤PDFä¸­çš„ä»¥ä¸‹å…ƒç´ ï¼š
1. **é¡µçœ‰** - åˆ é™¤æ–°é¡µé¢çš„é¡µçœ‰ä¿¡æ¯
2. **å›¾è¡¨æ ‡é¢˜** - åˆ é™¤æ¯ä¸ªå›¾è¡¨ä¸Šæ–¹çš„æ ‡é¢˜æ–‡å­—
3. **é¡µç ï¼ˆå±…ä¸­ï¼‰** - åˆ é™¤é¡µé¢åº•éƒ¨çš„é¡µç ä¿¡æ¯
4. **å¯¼å‡ºæ—¶é—´ï¼ˆå³ä¾§ï¼‰** - åˆ é™¤é¡µé¢åº•éƒ¨çš„å¯¼å‡ºæ—¶é—´

## ğŸ”§ ä¿®æ”¹å†…å®¹

### 1. unitOverviewReport ä¿®æ”¹

#### åˆ é™¤é¡µçœ‰å’Œå›¾è¡¨æ ‡é¢˜
**ä¿®æ”¹ä½ç½®ï¼š** `src/views/reportForms/unitOverviewReport/utils/hook.tsx`

**ä¿®æ”¹å‰ï¼š**
```typescript
// æ£€æŸ¥æ˜¯å¦éœ€è¦æ–°é¡µé¢
if (currentPositionY > pdfHeight - 150) {
  pdf.addPage();
  currentPositionY = 30;

  // åœ¨æ–°é¡µæ·»åŠ é¡µçœ‰
  pdf.setFillColor(240, 240, 240);
  pdf.rect(0, 0, pdfWidth, 15, "F");
  await addChineseText(pdf, `å•ä½æ¦‚è§ˆæŠ¥è¡¨ - è¯¦ç»†å›¾è¡¨`, pdfWidth / 2, 10, {
    fontSize: 10,
    align: "center",
    color: [100, 100, 100]
  });
  currentPositionY = 30;
}

// å¢åŠ å›¾è¡¨å‰çš„é—´è·
currentPositionY += 15;

// å›¾è¡¨æ ‡é¢˜
await addChineseText(pdf, chart.title, margin, currentPositionY, {
  fontSize: 16,
  color: "#2c3e50"
});
currentPositionY += 12;
```

**ä¿®æ”¹åï¼š**
```typescript
// æ£€æŸ¥æ˜¯å¦éœ€è¦æ–°é¡µé¢
if (currentPositionY > pdfHeight - 150) {
  pdf.addPage();
  currentPositionY = 30;
}

// å¢åŠ å›¾è¡¨å‰çš„é—´è·
currentPositionY += 15;
```

#### åˆ é™¤é¡µè„šï¼ˆé¡µç å’Œå¯¼å‡ºæ—¶é—´ï¼‰
**ä¿®æ”¹å‰ï¼š**
```typescript
// æ·»åŠ é¡µè„š
const pageCount = pdf.getNumberOfPages();
for (let i = 1; i <= pageCount; i++) {
  pdf.setPage(i);

  // ç»˜åˆ¶é¡µè„šåˆ†éš”çº¿
  pdf.setDrawColor(220, 220, 220);
  pdf.setLineWidth(0.5);
  pdf.line(margin, pdfHeight - 15, pdfWidth - margin, pdfHeight - 15);

  // æ·»åŠ é¡µç ï¼ˆå±…ä¸­ï¼‰
  await addChineseText(pdf, `ç¬¬ ${i} é¡µ / å…± ${pageCount} é¡µ`, pdfWidth / 2, pdfHeight - 10, {
    fontSize: 9,
    align: "center",
    color: [120, 120, 120]
  });

  // æ·»åŠ å¯¼å‡ºæ—¶é—´ï¼ˆå³ä¾§ï¼‰
  await addChineseText(pdf, `å¯¼å‡ºæ—¶é—´ï¼š${dayjs().format("YYYY-MM-DD HH:mm")}`, pdfWidth - margin, pdfHeight - 10, {
    fontSize: 8,
    align: "right",
    color: [150, 150, 150]
  });

  // æ·»åŠ æŠ¥è¡¨åç§°ï¼ˆå·¦ä¾§ï¼‰
  await addChineseText(pdf, "å•ä½æ¦‚è§ˆæŠ¥è¡¨", margin, pdfHeight - 10, {
    fontSize: 8,
    align: "left",
    color: [150, 150, 150]
  });
}
```

**ä¿®æ”¹åï¼š**
```typescript
// é¡µè„šå·²åˆ é™¤
```

### 2. newEnergyReport ä¿®æ”¹

#### åˆ é™¤å›¾è¡¨æ ‡é¢˜
**ä¿®æ”¹ä½ç½®ï¼š** `src/views/reportForms/newEnergyReport/utils/hook.tsx`

**ä¿®æ”¹å‰ï¼š**
```typescript
// å¢åŠ å›¾è¡¨å‰çš„é—´è·
currentPositionY += 15;

// å›¾è¡¨æ ‡é¢˜ - ä½¿ç”¨æ›´å¥½çš„æ ·å¼
await addChineseText(pdf, chart.title, margin, currentPositionY, {
  fontSize: 16,
  color: "#2c3e50"
});
currentPositionY += 12; // å¢åŠ æ ‡é¢˜åçš„é—´è·
```

**ä¿®æ”¹åï¼š**
```typescript
// å¢åŠ å›¾è¡¨å‰çš„é—´è·
currentPositionY += 15;
```

#### åˆ é™¤é¡µè„š
**ä¿®æ”¹å‰ï¼š**
```typescript
// æ·»åŠ é¡µè„š
await addChineseText(pdf2, `å¯¼å‡ºæ—¥æœŸ: ${dayjs().format("YYYY-MM-DD")}`, pageWidth / 2, pageHeight - 10, {
  fontSize: 8,
  align: "center",
  color: [100, 100, 100]
});
```

**ä¿®æ”¹åï¼š**
```typescript
// é¡µè„šå·²åˆ é™¤
```

## ğŸ“Š ä¿®æ”¹æ•ˆæœå¯¹æ¯”

### ä¿®æ”¹å‰ vs ä¿®æ”¹å

| å…ƒç´  | ä¿®æ”¹å‰ | ä¿®æ”¹å |
|------|--------|--------|
| **é¡µçœ‰** | âœ… æ˜¾ç¤º"å•ä½æ¦‚è§ˆæŠ¥è¡¨ - è¯¦ç»†å›¾è¡¨" | âŒ å·²åˆ é™¤ |
| **å›¾è¡¨æ ‡é¢˜** | âœ… æ˜¾ç¤ºå›¾è¡¨åç§°ï¼ˆå¦‚"æœˆæ€»ç”µé‡"ï¼‰ | âŒ å·²åˆ é™¤ |
| **é¡µç ** | âœ… æ˜¾ç¤º"ç¬¬ X é¡µ / å…± Y é¡µ" | âŒ å·²åˆ é™¤ |
| **å¯¼å‡ºæ—¶é—´** | âœ… æ˜¾ç¤º"å¯¼å‡ºæ—¶é—´ï¼šYYYY-MM-DD HH:mm" | âŒ å·²åˆ é™¤ |
| **é¡µè„šåˆ†éš”çº¿** | âœ… æ˜¾ç¤ºç°è‰²åˆ†éš”çº¿ | âŒ å·²åˆ é™¤ |
| **æŠ¥è¡¨åç§°** | âœ… æ˜¾ç¤º"å•ä½æ¦‚è§ˆæŠ¥è¡¨" | âŒ å·²åˆ é™¤ |

### è§†è§‰æ•ˆæœå˜åŒ–

#### ä¼˜ç‚¹
- âœ… **æ›´ç®€æ´çš„å¸ƒå±€**ï¼šå»é™¤äº†å¤šä½™çš„æ–‡å­—ä¿¡æ¯
- âœ… **æ›´å¤§çš„å†…å®¹ç©ºé—´**ï¼šå›¾è¡¨å’Œè¡¨æ ¼æœ‰æ›´å¤šæ˜¾ç¤ºç©ºé—´
- âœ… **æ›´ä¸“æ³¨çš„å†…å®¹**ï¼šç”¨æˆ·æ³¨æ„åŠ›é›†ä¸­åœ¨æ•°æ®æœ¬èº«
- âœ… **æ›´å¹²å‡€çš„å¤–è§‚**ï¼šå‡å°‘äº†è§†è§‰å¹²æ‰°å…ƒç´ 

#### æ³¨æ„äº‹é¡¹
- âš ï¸ **æ— é¡µç ä¿¡æ¯**ï¼šå¤šé¡µPDFæ—¶ç”¨æˆ·æ— æ³•çŸ¥é“å½“å‰é¡µæ•°
- âš ï¸ **æ— å¯¼å‡ºæ—¶é—´**ï¼šæ— æ³•çŸ¥é“PDFçš„ç”Ÿæˆæ—¶é—´
- âš ï¸ **æ— å›¾è¡¨æ ‡è¯†**ï¼šéœ€è¦é€šè¿‡å›¾è¡¨å†…å®¹åˆ¤æ–­å›¾è¡¨ç±»å‹

## ğŸ¯ é€‚ç”¨åœºæ™¯

### é€‚åˆä½¿ç”¨ç®€åŒ–ç‰ˆçš„åœºæ™¯
- **å†…éƒ¨ä½¿ç”¨**ï¼šå›¢é˜Ÿå†…éƒ¨æŸ¥çœ‹æ•°æ®ï¼Œä¸éœ€è¦æ­£å¼æ ¼å¼
- **å¿«é€Ÿé¢„è§ˆ**ï¼šä¸´æ—¶æŸ¥çœ‹æ•°æ®è¶‹åŠ¿å’Œæ¦‚å†µ
- **æ‰“å°è¾“å‡º**ï¼šå‡å°‘å¢¨æ°´ä½¿ç”¨ï¼Œæ›´ç¯ä¿
- **ç§»åŠ¨è®¾å¤‡**ï¼šåœ¨å°å±å¹•ä¸ŠæŸ¥çœ‹æ—¶æ›´æ¸…æ™°

### å¯èƒ½éœ€è¦å®Œæ•´ç‰ˆçš„åœºæ™¯
- **æ­£å¼æŠ¥å‘Š**ï¼šéœ€è¦æäº¤ç»™ä¸Šçº§æˆ–å®¢æˆ·çš„æ­£å¼æ–‡æ¡£
- **å­˜æ¡£å¤‡ä»½**ï¼šéœ€è¦è®°å½•ç”Ÿæˆæ—¶é—´çš„å†å²æ•°æ®
- **å¤šé¡µæ–‡æ¡£**ï¼šéœ€è¦é¡µç å¯¼èˆªçš„é•¿æ–‡æ¡£
- **å¤–éƒ¨åˆ†äº«**ï¼šéœ€è¦å®Œæ•´ä¿¡æ¯çš„å¯¹å¤–æ–‡æ¡£

## ğŸ”„ å¦‚ä½•æ¢å¤å®Œæ•´ç‰ˆ

å¦‚æœéœ€è¦æ¢å¤é¡µçœ‰ã€é¡µè„šã€å›¾è¡¨æ ‡é¢˜ç­‰å…ƒç´ ï¼Œå¯ä»¥ï¼š

### æ–¹æ³•1ï¼šä»£ç å›æ»š
```bash
# ä½¿ç”¨gitæ¢å¤åˆ°ä¿®æ”¹å‰çš„ç‰ˆæœ¬
git checkout HEAD~1 -- src/views/reportForms/unitOverviewReport/utils/hook.tsx
git checkout HEAD~1 -- src/views/reportForms/newEnergyReport/utils/hook.tsx
```

### æ–¹æ³•2ï¼šæ‰‹åŠ¨æ·»åŠ 
é‡æ–°æ·»åŠ è¢«åˆ é™¤çš„ä»£ç æ®µï¼š
- é¡µçœ‰ï¼šåœ¨æ–°é¡µé¢æ·»åŠ æ—¶æ¢å¤é¡µçœ‰ç»˜åˆ¶ä»£ç 
- å›¾è¡¨æ ‡é¢˜ï¼šåœ¨å›¾è¡¨æ¸²æŸ“å‰æ¢å¤æ ‡é¢˜æ·»åŠ ä»£ç 
- é¡µè„šï¼šåœ¨PDFä¿å­˜å‰æ¢å¤é¡µè„šå¾ªç¯ä»£ç 

### æ–¹æ³•3ï¼šé…ç½®é€‰é¡¹
å¯ä»¥æ·»åŠ é…ç½®å‚æ•°æ¥æ§åˆ¶æ˜¯å¦æ˜¾ç¤ºè¿™äº›å…ƒç´ ï¼š
```typescript
const pdfOptions = {
  showHeader: false,    // æ˜¯å¦æ˜¾ç¤ºé¡µçœ‰
  showTitle: false,     // æ˜¯å¦æ˜¾ç¤ºå›¾è¡¨æ ‡é¢˜
  showFooter: false,    // æ˜¯å¦æ˜¾ç¤ºé¡µè„š
  showPageNumber: false // æ˜¯å¦æ˜¾ç¤ºé¡µç 
};
```

## ğŸ“ ä½¿ç”¨è¯´æ˜

### å½“å‰çŠ¶æ€
- **unitOverviewReport**ï¼šå·²åˆ é™¤é¡µçœ‰ã€å›¾è¡¨æ ‡é¢˜ã€é¡µè„š
- **newEnergyReport**ï¼šå·²åˆ é™¤å›¾è¡¨æ ‡é¢˜ã€é¡µè„š

### ç”Ÿæˆçš„PDFç‰¹ç‚¹
1. **çº¯å†…å®¹å±•ç¤º**ï¼šåªåŒ…å«å›¾è¡¨å’Œè¡¨æ ¼æ•°æ®
2. **æ— é¢å¤–ä¿¡æ¯**ï¼šæ²¡æœ‰é¡µç ã€æ—¶é—´ã€æ ‡é¢˜ç­‰å…ƒç´ 
3. **ç®€æ´å¸ƒå±€**ï¼šæ›´å¤šç©ºé—´ç”¨äºæ•°æ®å±•ç¤º
4. **å¿«é€Ÿæµè§ˆ**ï¼šå‡å°‘è§†è§‰å¹²æ‰°ï¼Œä¸“æ³¨æ•°æ®å†…å®¹

### æ–‡ä»¶å‘½å
PDFæ–‡ä»¶åä»ç„¶åŒ…å«æ—¶é—´ä¿¡æ¯ï¼š
- `å•ä½æ¦‚è§ˆæŠ¥è¡¨_YYYY-MM.pdf`
- `å…‰ä¼å‘ç”µæ•°æ®æŠ¥è¡¨_YYYYMMDD_ç®€åŒ–ç‰ˆ.pdf`

## ğŸ‰ æ€»ç»“

é€šè¿‡åˆ é™¤é¡µçœ‰ã€å›¾è¡¨æ ‡é¢˜ã€é¡µç å’Œå¯¼å‡ºæ—¶é—´ï¼ŒPDFæŠ¥è¡¨å˜å¾—æ›´åŠ ï¼š

- âœ… **ç®€æ´æ˜äº†**ï¼šå»é™¤å†—ä½™ä¿¡æ¯ï¼Œçªå‡ºæ ¸å¿ƒæ•°æ®
- âœ… **ç©ºé—´åˆ©ç”¨**ï¼šæ›´å¤šç©ºé—´ç”¨äºå›¾è¡¨å’Œè¡¨æ ¼æ˜¾ç¤º
- âœ… **è§†è§‰æ¸…çˆ½**ï¼šå‡å°‘æ–‡å­—å¹²æ‰°ï¼Œæå‡é˜…è¯»ä½“éªŒ
- âœ… **æ‰“å°å‹å¥½**ï¼šå‡å°‘å¢¨æ°´ä½¿ç”¨ï¼Œæ›´é€‚åˆæ‰“å°

ç°åœ¨çš„PDFä¸“æ³¨äºæ•°æ®å±•ç¤ºï¼Œä¸ºç”¨æˆ·æä¾›æ›´çº¯ç²¹çš„æ•°æ®æŸ¥çœ‹ä½“éªŒï¼ğŸš€

---

**ä¿®æ”¹çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ  
**å½±å“èŒƒå›´**ï¼šunitOverviewReport + newEnergyReport  
**è§†è§‰æ•ˆæœ**ï¼šğŸ¨ ç®€æ´åŒ–
